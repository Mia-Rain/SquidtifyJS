<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
var urlParams = new URLSearchParams(window.location.search);
console.log(urlParams.get('code'));
var code = urlParams.get('code');
const CLID = sessionStorage.getItem('CLID');
const CLSEC = sessionStorage.getItem('CLSEC');
let params = {
      client_id: CLID,
      client_secret: CLSEC,
      redirect_uri: 'https://www.thatgeekyweeb.is-dummy-thi.cc/SquidtifyJS/callback/',
      code,
      grant_type: "authorization_code"
};
axios({
      method: "post",
      url: "https://accounts.spotify.com/api/token",
      params: {
            client_id: CLID,
            client_secret: CLSEC,
            code,
            grant_type: 'authorization_code',
            redirect_uri: 'https://www.thatgeekyweeb.is-dummy-thi.cc/SquidtifyJS/callback/'
        },
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
      }
      data: null,
    })
      .then(response => {
        sessionStorage.setItem('refresh_token', response.data.refresh_token);
        console.log('authed');
      })
      .catch(error => {
         console.log(error);
         console.log(error.response);
      });
const refresh_token = sessionStorage.getItem('refresh_token');
console.log(refresh_token);
</script>
