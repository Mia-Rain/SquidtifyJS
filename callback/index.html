<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script>
var urlParams = new URLSearchParams(window.location.search);
console.log(urlParams.get('code'));
var code = urlParams.get('code');
const CLID = sessionStorage.getItem('CLID');
const CLSEC = sessionStorage.getItem('CLSEC');
let params = {
      client_id: CLID,
      client_secret: CLSEC,
      redirect_uri: 'https://www.thatgeekyweeb.is-dummy-thi.cc/SquidtifyJS/callback/',
      code,
      grant_type: "authorization_code"
};
$.ajax({
            type: 'POST',
            url: "https://accounts.spotify.com/api/token",
            headers: {'Content-Type': 'application/x-www-form-urlencoded'},
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            dataType: 'json',
            data: { 'client_id': CLID, 'client_secret': CLSEC, 'redirect_uri': 'https://www.thatgeekyweeb.is-dummy-thi.cc/SquidtifyJS/callback/', code, 'grant_type': "authorization_code" },
            	success: function (response) {
                console.log(response);
                sessionStorage.setItem('refresh_token', response.refresh_token);
                return response;
		}
});
const refresh_token = sessionStorage.getItem('refresh_token');
console.log(refresh_token);
</script>
